# 模糊神经网络

模糊系统的**规则集**和**隶属度函数**等设计参数只能靠**设计经验**来选择

用神经网络的学习方法，根据输入输出的学习样本自动设计和调整模糊系统的**设计参数**

实现模糊系统的**自学习和自适应功能**

**结构上像神经网络**，**功能上是模糊系统**

## 模糊神经网络的结构

该网络**共分 5 层**，是根据模糊系统的工作过程来设计的，是神经网络实现的模糊推理系统。

可以调整
- 第二层的隶属函数参数
- 三、四层间及四、五层间的连接权

结构
- 第一层为输入层，为精确值。
  - 节点个数为输入变量的个数
- 第二层为输入变量的隶属函数层
  - 实现输入变量的模糊化
- 第三层也称“与”层
  - 该层节点个数为模糊规则数
  - 该层每个节点只与第二层中前 m 个节点中的一个和后 n 个节点中的一个相连，共有 m ×n 个节点也就是有 m ×n 条规则
- 第四层为“或”层
  - 节点数为输出变量模糊度划分的个数 q
  - 该层与第三层的连接为全互连，连接权值为 $W_kj$
- 第五层为清晰化层
  - 节点数为输出变量的个数
  - 第五层为清晰化层，节点数为输出变量的个数

## 模糊神经网络的学习算法

需要学习的参数：
- 隶属度函数的中心和宽度
- 反模糊化层和归一化层之间的连接权

两种常用的方法
- BP 算法
- 三种参数分阶段训练

# 自适应神经模糊推理系统（ANFIS）

ANFIS 是一种基于 **T-S 模型** 的自适应神经 - 模糊推理系统

融合了**神经网络的学习机制**和**模糊系统的语言推理能力**等优点

T-S 模型的主要特征是**模型结论部分由线性函数**组成

ANFIS 使用一个**给定的输入输出数据集**，从而构造出一个模糊推理系统 (支持 T-S 型系统)，并用一个单独的**反向传播算法**或该算法**与最小二乘法相结合的方法**来完成对系统隶属函数参数的调节。这使得模糊系统可以从其建模数据中学习信息。

## ANFIS 的结构

ANFIS 属于 Sugeno 型模糊系统，由前件和后件构成

设输入变量 x、y 的 Sigmoid 型隶属度函数为：

$$
S_{A_i}(x, a_i, b_i) = \frac{1}{1 + e^{-a_i (x - b_i)}}
$$

$$
S_{B_i}(y, c_i, d_i) = \frac{1}{1 + e^{-c_i (x - d_i)}}
$$

- 第一层的功能是计算输入的模糊隶属度

$$
O_{1,j} = S_{A_j}(x, a_j, b_j),\quad i = 1,\ 2
$$

$$
O_{1,j} = S_{B_{j-2}}(y, c_{j-2}, d_{j-2}),\quad j = 3,\ 4
$$

- 第二层的功能是计算每条规则的适应度

$$
O_{2,1} = O_{1,1} \times O_{1,3} = S_{A_1}(x, a_1, b_1) \times S_{B_1}(y, c_1, d_1) \quad \text{记作} \, W_1
$$

$$
O_{2,2} = O_{1,2} \times O_{1,4} = S_{A_2}(x, a_2, b_2) \times S_{B_2}(y, c_2, d_2) \quad \text{记作} \, W_2
$$

- 第三层的功能是计算适应度的归一化值

$$
O_{3,1} = \overline{W_1} = \frac{W_1}{W_1 + W_2}
\qquad
O_{3,2} = \overline{W_2} = \frac{W_2}{W_1 + W_2}
$$

- 第四层的功能是计算每条规则的输出

$$
O_{4,1} = \overline{W_1} z_1 = \overline{W_1} (p_1 x + q_1 y + r_1)
$$

$$
O_{4,2} = \overline{W_2} z_2 = \overline{W_2} (p_2 x + q_2 y + r_2)
$$

- 第五层的功能是计算模糊系统的输出

$$
O_5 = z = \sum \overline{W_i} z_i = \overline{W_1} z_1 + \overline{W_2} z_2
$$

在这一网络中，包含了待定的特征参数隶属度函数中的参数 (ai,bi,ci,di (i=1,2) ) 和结论参数
(pi,qi,ri (i=1,2))。

ANFIS 在训练过程中，动态地调整这些参数，以实现自适应学习，从而使得网络能更加准确地描述输入与输出数据之间的映射关系

## ANFIS 的原理

### 输入变量空间划分

- 网格分类法
  - 对于每个输入变量，只需要少数几条 if-then 规则
  - 维度爆炸
- 减法聚类法
  - 选择周围具有最高数据点密度的数据点作为第一个聚类中心
  - 剔除第一个聚类中心附近的所有不可能作为聚类中心的数据点，从剩余的可能作为聚类中心的数据点中，继续采用类似的方法选择下一个聚类中心
  - 持续这一过程，直到所有剩余的数据点作为聚类中心的可能性低于某一阈值

### 隶属函数的确定

- 隶属函数的数量
  - 由经验而定或采用试凑法确定
- 输入隶属函数的类型
  - 可以是任意一种参数化的 MF
- 输出隶属函数的类型
  - ANFIS 属于 Sugeno 型模糊系统，所以输出变量隶属函数只有两种
    - 常数 (Constant)--零阶 Sugeno 型模糊系统的输出
    - 线性函数 (Linear)--一阶 Sugeno 型模糊系统的输出

### 学习法则及方式

- 误差反传学习算法
- 混合型学习算法
  - 最小二乘法和梯度下降法相结合的算法

### ANFIS 控制方法

- 专家控制
- 逆控制
